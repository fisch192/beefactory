---
export const prerender = true;
import ShopLayout from '../../layouts/ShopLayout.astro';
import Hero from '../../components/Hero.astro';
import FeatureGrid from '../../components/FeatureGrid.astro';
import ProductCard from '../../components/ProductCard.astro';
import CategoryCard from '../../components/CategoryCard.astro';
import NeuimkerSpotlight from '../../components/NeuimkerSpotlight.astro';
import SeasonalGuide from '../../components/SeasonalGuide.astro';
import Testimonials from '../../components/Testimonials.astro';
import Newsletter from '../../components/Newsletter.astro';
import CartDrawer from '../../components/cart/CartDrawer';
import { t } from '../../lib/i18n';
import { getFeaturedProductsAsync } from '../../data/products';
import { getCollections } from '../../data/collections';

const lang = 'de';
const featured = await getFeaturedProductsAsync();
const collections = await getCollections();
---

<ShopLayout lang={lang} canonicalPath="/de/" hasHero={true}>
  <!-- 1. Hero -->
  <Hero lang={lang} />

  <!-- 2. USP Bar -->
  <FeatureGrid lang={lang} />

  <!-- 3. Featured Products -->
  <section class="section-products">
    <div class="container-wide">
      <div class="section-header fade-in">
        <span class="eyebrow">Unsere Auswahl</span>
        <h2 class="display-md mt-4">{t('featured.title', lang)}</h2>
        <p class="section-sub">{t('featured.subtitle', lang)}</p>
      </div>
      <div class="products-grid">
        {featured.map((product) => (
          <ProductCard product={product} lang={lang} />
        ))}
      </div>
    </div>
  </section>

  <!-- 4. Category Grid (Bento) -->
  <section id="categories" class="section-categories">
    <div class="container-wide">
      <div class="section-header fade-in">
        <span class="eyebrow">Sortiment</span>
        <h2 class="display-md mt-4">{t('categories.title', lang)}</h2>
        <p class="section-sub">{t('categories.subtitle', lang)}</p>
      </div>
      <div class="categories-grid">
        {collections.map((col, i) => (
          <CategoryCard collection={col} lang={lang} size={i === 0 ? 'large' : 'normal'} />
        ))}
      </div>
    </div>
  </section>

  <!-- 5. Neuimker Spotlight -->
  <NeuimkerSpotlight lang={lang} />

  <!-- 6. Seasonal Guide -->
  <SeasonalGuide lang={lang} />

  <!-- 7. Testimonials -->
  <Testimonials lang={lang} />

  <!-- 8. Newsletter -->
  <Newsletter lang={lang} />

  <!-- Cart Drawer (Preact island) -->
  <CartDrawer
    client:load
    title={t('cart.title', lang)}
    emptyText={t('cart.empty', lang)}
    totalText={t('cart.total', lang)}
    checkoutText={t('cart.checkout', lang)}
    continueText={t('cart.continue', lang)}
    removeText={t('cart.remove', lang)}
  />
</ShopLayout>

<style>
  /* ── Products section ───────────────────────────── */
  .section-products {
    background:     var(--color-void);
    padding-top:    clamp(5rem, 10vw, 12rem);
    padding-bottom: clamp(5rem, 10vw, 12rem);
  }

  /* ── Categories section ─────────────────────────── */
  .section-categories {
    background:     var(--color-machined);
    padding-top:    clamp(5rem, 10vw, 12rem);
    padding-bottom: clamp(5rem, 10vw, 12rem);
  }

  /* ── Shared section header ──────────────────────── */
  .section-header {
    text-align:    center;
    margin-bottom: clamp(3rem, 6vw, 5rem);
  }

  .section-sub {
    font-size:   1rem;
    color:       var(--color-ash);
    line-height: 1.65;
    margin-top:  1rem;
  }

  /* ── Products grid ──────────────────────────────── */
  .products-grid {
    display:               grid;
    grid-template-columns: 1fr;
    gap:                   1.5rem;
  }
  @media (min-width: 640px)  { .products-grid { grid-template-columns: repeat(2, 1fr); } }
  @media (min-width: 1024px) { .products-grid { grid-template-columns: repeat(4, 1fr); gap: 2rem; } }

  /* ── Categories bento grid ──────────────────────── */
  .categories-grid {
    display:               grid;
    grid-template-columns: 1fr;
    gap:                   1rem;
    auto-rows:             220px;
  }
  @media (min-width: 640px)  {
    .categories-grid {
      grid-template-columns: repeat(2, 1fr);
      auto-rows: 200px;
    }
  }
  @media (min-width: 1024px) {
    .categories-grid {
      grid-template-columns: repeat(3, 1fr);
      auto-rows: 240px;
    }
  }
</style>
